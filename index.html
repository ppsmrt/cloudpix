<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CloudPix â€” Premium Image Host</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<style>
body { font-family: 'Inter', sans-serif; background:#f8fafc; color:#1f2937; margin:0; min-height:100vh; display:flex; flex-direction:column;}
header { background:#fff; padding:16px; box-shadow:0 2px 8px rgba(0,0,0,0.05); display:flex; align-items:center; position:sticky; top:0; z-index:50;}
header .brand { display:flex; align-items:center; gap:12px; }
header .brand .logo { width:48px; height:48px; background: linear-gradient(135deg,#7c3aed,#06b6d4); color:white; font-weight:bold; font-size:18px; border-radius:12px; display:flex; align-items:center; justify-content:center; }
main { flex:1; max-width:920px; margin:16px auto; width:100%; padding:0 16px 120px;}
.card { background:#fff; border-radius:16px; padding:16px; box-shadow:0 6px 24px rgba(0,0,0,0.06); margin-bottom:16px;}
.btn { padding:10px 16px; border-radius:12px; font-weight:600; display:inline-flex; align-items:center; gap:8px; cursor:pointer; transition:.2s;}
.btn-primary { background: linear-gradient(90deg,#7c3aed,#06b6d4); color:white; box-shadow:0 4px 16px rgba(124,58,237,0.3); }
.btn-primary:hover { opacity:0.95; transform:translateY(-1px);}
.btn-ghost { background: transparent; border: 1px solid #d1d5db; color:#1f2937; }
.progress { height:8px; background:#e5e7eb; border-radius:999px; overflow:hidden; flex:1;}
.progress>div { height:100%; width:0%; background:linear-gradient(90deg,#06b6d4,#7c3aed); transition:width .2s linear;}
.gallery { display:grid; grid-template-columns:repeat(auto-fill,minmax(160px,1fr)); gap:12px;}
.tile { border-radius:12px; overflow:hidden; background:#f1f5f9; min-height:120px; display:flex; align-items:center; justify-content:center; position:relative; cursor:pointer; transition:transform .2s;}
.tile img { width:100%; height:100%; object-fit:cover; transition:transform .35s ease;}
.tile:hover img { transform:scale(1.05); }
.tile:hover { transform: translateY(-3px); box-shadow:0 8px 20px rgba(0,0,0,0.1); }
.tile .meta { position:absolute; left:6px; bottom:6px; right:6px; display:flex; justify-content:space-between; gap:4px;}
.chip { background: rgba(31,41,55,0.1); padding:4px 8px; border-radius:10px; font-size:12px; display:flex; align-items:center; gap:4px; color:#1f2937;}
.footer { background:#fff; padding:16px 0; text-align:center; color:#6b7280; font-size:13px; box-shadow:0 -2px 12px rgba(0,0,0,0.06);}
.toast-wrap { position:fixed; right:16px; bottom:140px; display:flex; flex-direction:column; gap:10px; align-items:flex-end; z-index:60;}
.toast { padding:10px 14px; border-radius:12px; box-shadow:0 4px 16px rgba(0,0,0,0.1); color:white; font-weight:600;}
.modal-backdrop { position:fixed; inset:0; background:rgba(0,0,0,0.65); display:flex; align-items:center; justify-content:center; z-index:70;}
.modal { max-width:92%; border-radius:16px; overflow:hidden; background:#fff; position:relative; touch-action: pan-y;}
.modal img { width:100%; height:auto; display:block; border-radius:12px;}
.modal .modal-controls { display:flex; justify-content:space-between; margin-top:8px;}
.modal .btn-copy { padding:6px 12px; font-size:14px;}
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">CP</div>
    <div>
      <div class="text-sm">CloudPix</div>
      <div class="text-xs text-gray-500">Premium Image Hosting</div>
    </div>
  </div>
</header>

<main>
  <div class="card">
    <h2 class="text-lg font-semibold mb-2">Upload Image</h2>
    <p class="text-sm text-gray-500 mb-3">Select an image to upload. Instant preview & shareable link.</p>
    <div class="flex items-center gap-4">
      <label for="file-input" class="btn btn-ghost"><i class="fa-solid fa-folder-open"></i> Choose file</label>
      <button id="upload-now" class="btn btn-primary hidden"><i class="fa-solid fa-cloud-upload-alt"></i> Upload</button>
    </div>
    <input type="file" id="file-input" accept="image/*" class="hidden mt-2"/>
    <div class="mt-3 flex items-center gap-3">
      <div class="progress flex-1"><div id="progress-bar"></div></div>
      <div id="status-text" class="text-xs text-gray-500 w-36 text-right">No file selected</div>
    </div>
    <div class="mt-4" id="mini-preview">
      <div class="tile"><i class="fa-regular fa-image text-3xl text-gray-400"></i></div>
    </div>
  </div>

  <div class="card">
    <div class="flex items-center justify-between mb-3">
      <div>
        <div class="text-sm text-gray-500">Recent Uploads</div>
        <div class="text-xs text-gray-400">Tap to preview</div>
      </div>
      <div class="flex gap-2">
        <button id="refresh-gallery" class="btn-ghost"><i class="fa-solid fa-arrows-rotate"></i></button>
        <button id="clear-gallery" class="btn-ghost"><i class="fa-solid fa-trash"></i></button>
      </div>
    </div>
    <div id="gallery" class="gallery"></div>
  </div>
</main>

<div class="footer">
  &copy; 2025 CloudPix. All rights reserved.
</div>

<div class="toast-wrap" id="toasts"></div>
<div id="modal-root"></div>

<script>
const imgbbKey='8604e4b4050c63c460d0bca39cf28708';
const fileInput=document.getElementById('file-input');
const uploadNowBtn=document.getElementById('upload-now');
const progressBar=document.getElementById('progress-bar');
const statusText=document.getElementById('status-text');
const miniPreview=document.getElementById('mini-preview');
const gallery=document.getElementById('gallery');
const toasts=document.getElementById('toasts');
const modalRoot=document.getElementById('modal-root');
let currentFile=null;
let uploads=[];
let modalIndex=0;

function showToast(msg,type='info'){
  const el=document.createElement('div');
  el.className='toast';
  el.style.background=type==='success'?'#10b981':type==='error'?'#ef4444':'#06b6d4';
  el.textContent=msg;
  toasts.appendChild(el);
  setTimeout(()=>el.remove(),3000);
}

fileInput.addEventListener('change',e=>{if(e.target.files[0]) handleSelectedFile(e.target.files[0]);});

function handleSelectedFile(file){
  if(!file.type.startsWith('image/')){ showToast('Select image file','error'); return;}
  currentFile=file;
  statusText.textContent=`Ready: ${file.name}`;
  uploadNowBtn.classList.remove('hidden');
  const reader=new FileReader();
  reader.onload=ev=>{ miniPreview.innerHTML=`<img src="${ev.target.result}" class="w-full h-36 object-cover rounded"/>`; };
  reader.readAsDataURL(file);
  fileInput.value='';
}

uploadNowBtn.addEventListener('click',()=>{ if(currentFile) uploadFile(currentFile); });

function uploadFile(file){
  statusText.textContent='Uploading...'; progressBar.style.width='0%'; uploadNowBtn.classList.add('hidden');
  const form=new FormData(); form.append('image',file);
  const xhr=new XMLHttpRequest();
  xhr.open('POST',`https://api.imgbb.com/1/upload?key=${imgbbKey}`);
  xhr.upload.onprogress=e=>{ if(e.lengthComputable){ progressBar.style.width=Math.round((e.loaded/e.total)*100)+'%'; statusText.textContent=`Uploading ${Math.round((e.loaded/e.total)*100)}%`; }};
  xhr.onreadystatechange=function(){
    if(xhr.readyState===4){
      try{
        const res=JSON.parse(xhr.responseText);
        if(res.success){
          const url=res.data.url;
          statusText.textContent='Upload complete'; progressBar.style.width='100%'; showToast('Upload finished','success');
          addToGallery({url,name:file.name,time:new Date().toISOString()});
          currentFile=null; miniPreview.innerHTML='<div class="tile"><i class="fa-regular fa-image text-3xl text-gray-400"></i></div>';
        } else { showToast('Upload failed','error'); statusText.textContent='Upload failed'; }
      }catch(err){ showToast('Upload error','error'); statusText.textContent='Upload error'; }
      setTimeout(()=>progressBar.style.width='0%',700);
    }
  };
  xhr.onerror=function(){ statusText.textContent='Network error'; showToast('Network error','error'); uploadNowBtn.classList.remove('hidden'); };
  xhr.send(form);
}

function addToGallery(item){
  uploads.unshift(item);
  const tile=document.createElement('div'); tile.className='tile';
  tile.innerHTML=`<img src="${item.url}" alt="${item.name}" loading="lazy"/><div class="meta"><div class="chip">${new Date(item.time).toLocaleTimeString()}</div><div class="chip"><i class="fa-solid fa-link"></i></div></div>`;
  tile.addEventListener('click',()=>openModal(uploads.indexOf(item)));
  gallery.prepend(tile);
}

document.getElementById('refresh-gallery').addEventListener('click',()=>{ gallery.innerHTML=''; uploads.forEach(addToGallery); showToast('Gallery refreshed'); });
document.getElementById('clear-gallery').addEventListener('click',()=>{ gallery.innerHTML=''; uploads=[]; showToast('Gallery cleared'); });

function openModal(index){
  modalIndex=index;
  renderModal();
}

function renderModal(){
  const item=uploads[modalIndex];
  modalRoot.innerHTML=`<div class="modal-backdrop" id="modal-backdrop">
    <div class="modal p-4">
      <img src="${item.url}" alt="${item.name}" id="modal-img"/>
      <div class="modal-controls mt-2">
        <button class="btn btn-copy" id="prev-btn"><i class="fa-solid fa-arrow-left"></i></button>
        <span>${item.name}</span>
        <button class="btn btn-copy" id="modal-copy">Copy Link</button>
        <button class="btn btn-copy" id="next-btn"><i class="fa-solid fa-arrow-right"></i></button>
      </div>
    </div>
  </div>`;
  const backdrop=document.getElementById('modal-backdrop');
  backdrop.addEventListener('click',e=>{ if(e.target.id==='modal-backdrop') closeModal(); });
  document.getElementById('modal-copy').addEventListener('click',()=>{
    const mockupUrl=`https://ppsmrt.github.io/cloudpix?img=${encodeURIComponent(item.url)}`;
    navigator.clipboard.writeText(mockupUrl); showToast('Mockup link copied','success');
  });
  document.getElementById('prev-btn').addEventListener('click',()=>{ modalIndex=(modalIndex-1+uploads.length)%uploads.length; renderModal(); });
  document.getElementById('next-btn').addEventListener('click',()=>{ modalIndex=(modalIndex+1)%uploads.length; renderModal(); });
}

function closeModal(){ modalRoot.innerHTML=''; }
</script>
</body>
</html>
